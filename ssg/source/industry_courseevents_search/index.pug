extends /_templates/layout.pug
include /_templates/mixins.pug

block content
    if self.data.filters && process.env['DOMAIN'] === 'industry.poff.ee'
        h3#loading.sub_section_headline(style='display: grid; padding-top: 155px;')= self.label.filters.loading

        .search_filters#search_filters

            .search_date_filters#date_filters(style='display: none;')
                each date, key in self.data.filters.starttimes
                    label.date-option
                        input(class="date-input" type="checkbox", name="selectedDates", value=key)
                        span(class="date-input-value")
                            +formatDateShort(date)

            .grid_search#filters(style='display: none;')

                input#search(type='text', placeholder= self.label.filters.search)

                select#categories_select(name='Categories')
                    option(value='')= self.label.filters.industryCategories
                    each index, key in self.data.filters.categories
                        option(value=key)= index

                //- select#projects_select(name='Projects')
                //-     option(value='')= self.label.filters.projects
                //-     each index, key in self.data.filters.projects
                //-         option(value=key)= index

                select#persons_select(name='Persons')
                    option(value='')= self.label.filters.people
                    each index, key in self.data.filters.persons
                        option(value=key)= index

                select#location_select(name='Locations')
                    option(value='')= self.label.filters.location
                    each index, key in self.data.filters.locations
                        option(value=key)= index

                select.hidden#festivaleditions_select(name='Festivaleditions')
                    option(value='')= self.label.filters.festivalEdition
                    each index, key in self.data.filters.festivaleditions
                        option(value=key)= index

                select#eventtypes_select(name='Eventtypes')
                    option(value='')= self.label.filters.eventType
                    each index, key in self.data.filters.eventtypes
                        option(value=key)= index

                select#eventmodes_select(name='Eventmodes')
                    option(value='')= self.label.filters.eventMode
                    each index, key in self.data.filters.eventmodes
                        option(value=key)= index

                select#isliveevent_select(name='Isliveevent')
                    option(value='')= self.label.filters.isLive
                    each index, key in self.data.filters.isliveevent
                        option(value=key)= index

                select#eventaccess_select(name='Eventaccess')
                    option(value='')= self.label.filters.eventAccess
                    each index, key in self.data.filters.eventaccess
                        option(value=key)= index

                button.clear(onclick='unselect_all()')= self.label.filters.empty

                h3#nonetoshow.sub_section_headline(style='display: none;')

        section#content.schedule

            if self.data.industryevents

                
                -
                    var sortFunction = function(a, b) {
                        return !a.start_time.localeCompare(b.start_time)
                    }

                each event in self.data.industryevents.sort(sortFunction)
                    -
                        var screeningNames = function(item) {
                            let itemNames = item.title
                            return itemNames
                        }

                    .card_event(id=event.id)
                        .event_card_header
                            .event_card_header_left
                                .event_date
                                    svg(xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewbox='0 0 24 24' fill='none')
                                        path(d='M19 4H5C3.89543 4 3 4.89543 3 6V20C3 21.1046 3.89543 22 5 22H19C20.1046 22 21 21.1046 21 20V6C21 4.89543 20.1046 4 19 4Z' stroke='#12827E' stroke-linecap='round' stroke-linejoin='round')
                                        path(d='M16 2V6' stroke='#12827E' stroke-linecap='round' stroke-linejoin='round')
                                        path(d='M8 2V6' stroke='#12827E' stroke-linecap='round' stroke-linejoin='round')
                                        path(d='M3 10H21' stroke='#12827E' stroke-linecap='round' stroke-linejoin='round')
                                    span.screening_date.small_1
                                        if event.start_time
                                            +screeningDate(event.start_time)
                                .event_time
                                    svg(xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewbox='0 0 24 24' fill='none')
                                        path(d='M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z' stroke='#12827E' stroke-linecap='round' stroke-linejoin='round')
                                        path(d='M12 6V12L16 14' stroke='#12827E' stroke-linecap='round' stroke-linejoin='round')
                                    span.screening_time.small_1
                                        +screeningTimeEET(event.start_time)
                                    span.screening_time.small_1 &nbsp;EET&nbsp;
                                    span.screening_time_user.small_1 /&nbsp;
                                    span.screening_time_user.small_1
                                        +screeningTime(event.start_time)
                                    span.screening_time_user.small_1 &nbsp;user
                                if event.location
                                    .event_location
                                        svg(xmlns="http://www.w3.org/2000/svg", width="24", height="24", viewBox="0 0 24 24", fill="none")
                                            path(d="M21 10C21 17 12 23 12 23C12 23 3 17 3 10C3 7.61305 3.94821 5.32387 5.63604 3.63604C7.32387 1.94821 9.61305 1 12 1C14.3869 1 16.6761 1.94821 18.364 3.63604C20.0518 5.32387 21 7.61305 21 10Z", stroke="#12827E", stroke-linecap="round", stroke-linejoin="round")
                                            path(d="M12 13C13.6569 13 15 11.6569 15 10C15 8.34315 13.6569 7 12 7C10.3431 7 9 8.34315 9 10C9 11.6569 10.3431 13 12 13Z", stroke="#12827E", stroke-linecap="round", stroke-linejoin="round")
                                        span.location= event.location.name

                            .event_card_header_right
                                .grid_item_event_time.text_right
                                    svg(xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewbox='0 0 24 24' fill='none')
                                        path(d='M19 4H5C3.89543 4 3 4.89543 3 6V20C3 21.1046 3.89543 22 5 22H19C20.1046 22 21 21.1046 21 20V6C21 4.89543 20.1046 4 19 4Z' stroke='#636769' stroke-linecap='round' stroke-linejoin='round')
                                        path(d='M16 2V6' stroke='#636769' stroke-linecap='round' stroke-linejoin='round')
                                        path(d='M8 2V6' stroke='#636769' stroke-linecap='round' stroke-linejoin='round')
                                        path(d='M3 10H21' stroke='#636769' stroke-linecap='round' stroke-linejoin='round')
                                        path(d='M12 12V20' stroke='#636769' stroke-linecap='round' stroke-linejoin='round')
                                        path(d='M8 16H16' stroke='#636769' stroke-linecap='round' stroke-linejoin='round')
                                    span.screening_date.small_1.notsavedevent= 'Add to calendar'
                                    span.screening_date.small_1.notsavedevent(id=event.id+'_not_savedevent', style='display: none; cursor: pointer;' onclick=`modifyFavourites('addMyEvent', ${event.id}); calendarfile('${event.id}');`)= 'Add to calendar'
                                    span.screening_date.small_1.issavedevent(id=event.id+'_is_savedevent', style='display: none; cursor: pointer;' onclick=`modifyFavourites('rmMyEvent', ${event.id})`)= 'Remove from calendar'

                        a(href=`/${lang_path}events/${event.slug}`)
                            .event_card_content
                                //- if event.images && event.images[0]
                                //-     img(style='width:200px; height:200px;' src=`https://assets.poff.ee/img/${event.images[0].hash}${event.images[0].ext}`)
                                h3.event_title= event.title
                                    //- p(id= event.id+'nupp' style={color: 'red', display:'none'})

                                //- if event.industry_categories
                                //-     p.ce_info= `Category: ${event.industry_categories.map(c => c.name).join(', ')}`

                                //- //- if event.industry_categories
                                //- //-     p= `Categories: ${event.industry_categories.map(c => c.name).join(', ')}`

                                //- if event.event_mode
                                //-     p.ce_info= `Event mode: ${event.event_mode.name}`

                                //- if event.event_access
                                //-     p.ce_info= `Access: ${event.event_access}`

                                .event_card_keywords
                                    .event_card_keywords_left
                                        .button_group
                                            if event.industry_categories
                                                p.btn_outline= event.industry_categories.map(c => c.name).join(', ')
                                            if event.event_types
                                                p.btn_outline= event.event_types.join(', ')
                                        //- Temporary placeholder content
                                        p.keyword subject 1, keyword 2, subject 3
                                    .event_card_keywords_right
                                        if event.is_live_event
                                            .keyword
                                                svg(xmlns="http://www.w3.org/2000/svg", width="24", height="24", viewBox="0 0 24 24", fill="none")
                                                    path(d="M22 12H18L15 21L9 3L6 12H2", stroke="#636769", stroke-linecap="round", stroke-linejoin="round")
                                                span Live event
                                        if event.event_mode
                                            .keyword
                                                svg(xmlns="http://www.w3.org/2000/svg", width="24", height="24", viewBox="0 0 24 24", fill="none")
                                                    path(d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z", stroke="#636769", stroke-linecap="round", stroke-linejoin="round")
                                                    path(d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z", stroke="#636769", stroke-linecap="round", stroke-linejoin="round")
                                                span= event.event_mode.name
                                        if event.event_access
                                            .keyword
                                                svg(xmlns="http://www.w3.org/2000/svg", width="24", height="24", viewBox="0 0 24 24", fill="none")
                                                    path(d="M15 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H15", stroke="#636769", stroke-linecap="round", stroke-linejoin="round")
                                                    path(d="M10 17L15 12L10 7", stroke="#636769", stroke-linecap="round", stroke-linejoin="round")
                                                    path(d="M15 12H3", stroke="#636769", stroke-linecap="round", stroke-linejoin="round")
                                                span= event.event_access

                                //- .flekxboks
                                //-     if event.credentials && event.credentials.rolePersonsByRole
                                //-         each roleGroup, key in event.credentials.rolePersonsByRole
                                //-             //- Kui tahta teistsugust nö labelit kui role_at_film.roleName, siis saab kasutada loogikat nagu filmide all:
                                //-             //- ehk self.label.film.speaker nt ja kätte saab järgmise koodijupiga: self.label.film[key]
                                //-             if roleGroup.persons && roleGroup.persons.length
                                //-                 p.ce_info= `${roleGroup.roleName}: ${roleGroup.persons.join(', ')}`


                                //- if event.industry_people
                                //-     each industry_person in event.industry_people
                                //-         if industry_person.profilePicAtInd
                                //-             img(style='width:50px; height:50px;' src=`https://assets.poff.ee/img/${industry_person.profilePicAtInd.hash}${industry_person.profilePicAtInd.ext}`)

                                //-         p= `${industry_person.person.firstName} ${industry_person.person.lastName}`

                                //-         if industry_person.industry_person_types
                                //-             p= `Ind.PersonTypes: ${industry_person.industry_person_types.map(p => p.type).join(', ')}`

                                //-         if industry_person.role_at_films
                                //-             p= `Ind.PersonRoleAtFilms: ${industry_person.role_at_films.map(p => p.roleName).join(', ')}`

                                //- if event.description
                                //-     p
                                //-         +format(event.description)

                                //- if event.industry_categories
                                //-     p= `Categories: ${event.industry_categories.map(c => c.name).join(', ')}`

                                //- if event.start_time
                                //-     p Start time:
                                //-     p
                                //-         +screeningDate(event.start_time)
                                //-     p
                                //-         +screeningTime(event.start_time)

                                //- if event.durationTime
                                //-     p Duration:
                                //-     p
                                //-         +indEvDur(event.durationTime)

                                //- if event.project_type
                                //-     p= `Type: ${event.project_type}`


                                //- if event.videoUrl
                                //-     p= `Video at: ${event.videoUrl}`

                                //- p= `Public: ${event.isPublicEvent ? 'Yes' : 'No'}`
                                //- p= `Live: ${event.isLiveEvent ? 'Yes' : 'No'}`





                        //- .event_card_footer
                        //-     .grid_container_screening_time_2
                        //-         div
                        //-             svg.svg_icon_small(viewBox='0 0 24 24' width='24' height='24' stroke='white' stroke-width='1' fill='none' stroke-linecap='round' stroke-linejoin='round')
                        //-                 circle(cx='12' cy='12' r='10')
                        //-                 polyline(points='12 6 12 12 16 14')
                        //-             span.screening_time.small_1
                        //-                 +screeningTime(event.start_time)
                        //-             span.screening_time.small_1 &nbsp;User

                        //-         .text_left
                        //-             svg.svg_icon_small_primary(viewBox='0 0 24 24' width='24' height='24' stroke='#4fc4bf' stroke-width='1' fill='none' stroke-linecap='round' stroke-linejoin='round')
                        //-                 rect(x='3' y='4' width='18' height='18' rx='2' ry='2')
                        //-                 line(x1='16' y1='2' x2='16' y2='6')
                        //-                 line(x1='8' y1='2' x2='8' y2='6')
                        //-                 line(x1='3' y1='10' x2='21' y2='10')
                        //-             span.screening_date.small_1(onclick=`calendarfile('${event.id}');return false`)= 'Add to calendar'

                        //- Selle peidetud inputi sees on data
                        span(id=`cal_${event.id}` style='display: none') #{event.calendar_data}





                script.
                    var searcharray = !{JSON.stringify(self.data.search)}

                    var filters = !{JSON.stringify(self.data.filters)}
